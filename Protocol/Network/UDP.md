## 概述
UDP用来支持那些需要在计算机之间传输数据的网络应用，包括网络视频会议系统在内的众多的客户/服务器模式的网络应用。UDP报文没有可靠性保证、顺序保证和流量控制字段等，可靠性较差。但是正因为UDP协议的控制选项较少，在数据传输过程中延迟小、数据传输效率高，适合对可靠性要求不高的应用程序，或者可以保障可靠性的应用程序，如DNS、TFTP、SNMP等

## 特点
1. 无连接，时间上不存在建立连接需要的时延，空间上不维护连接状态，也不跟踪如TCP所有的拥塞控制、序号与确认号等参数，开销小。
2. 分组首部开销小，TCP首部20字节，UDP首部8字节。
3. 没有拥塞控制，应用层能够更好的控制要发送的数据和发送时间，网络中的拥塞控制也不会影响主机的发送速率。
4. 不保证可靠交付，没有TCP的确认机制、重传机制。如果因为网络原因没有传送到对端，UDP也不会给应用层返回错误信息。
5. 是面向报文的，对应用层下来的报文，添加首部后直接交付为 IP 层，对 IP 层上来的 UDP 用户数据报，在去除首部后交付给上层应用进程，报文不可分割，是UDP数据报处理的最小单位。 \
正是因为这样，其不能控制读写数据的次数和数量。比如我们要发送100个字节的报文，我们调用一次 sendto 函数就会发送100字节，对端也需要用 recvfrom 函数一次性接收100字节，不能使用循环每次获取10个字节，获取十次这样的做法。
6. 用于一次性传输比较少量数据的网络应用，如DNS,SNMP等。或多媒体应用（如IP电话，实时视频会议，流媒体等），数据的可靠传输对他们而言并不重要，但在意延时。
7. 支持一对一、一对多、多对一和多对多的交互通信。

## 首部格式
<img src="../../Pic/Protocol/Network/udp-head.png" style="width:500px;padding:10px;"/>

1. 源端口: 占16位、源端口号。在需要对方回信时选用。不需要时可用全0。
2. 目的端口: 占16位、目的端口号。这在终点交付报文时必须使用。
3. 长度: 占16位、UDP用户数据报的长度,其最小值是8(仅有首部)。
4. 检验和: 占16位、检测UDP用户数据报在传输中是否有错。有错就丢弃。

## 校验
1. 发送方，首先是把全零放入校验和字段并且添加伪首部。
2. 把UDP数据报看成是由许多16位的子串连接起来，若UDP数据报的数据部分不是偶数个字节，则要在数据部分末尾增加一个全零字节（此字节不发送）。
3. 按照二进制反码计算出这些16位字的和。将此和的二进制反码写入校验和字段。
4. 在接收方，把收到得UDP数据报加上伪首部（如果不为偶数个字节，还需要补上全零字节）后，按二进制反码计算出这些16位字的和。
5. 当无差错时其结果全为1,。否则就表明有差错出现，接收方应该丢弃这个UDP数据报。
<img src="../../Pic/Protocol/Network/udp-check.png" style="width:500px;padding:10px;"/>