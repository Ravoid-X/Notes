## 概述
1. 上下文指的是系统在特定时刻为执行某段代码所需的所有状态和信息
2. 最主要的两种上下文是 执行上下文 和 安全上下文
## 执行上下文
指内核在执行代码时所处的环境状态，主要分为两种 进程上下文 和 中断上下文
### 进程上下文
1. 当一个进程通过系统调用陷入内核，或者一个内核线程被调度运行时，CPU 就处于进程上下文中
2. 包含了该进程的完整执行环境。当一个进程被暂停（切换出去）时，内核需要保存它的所有上下文信息，以便将来恢复\
（1）CPU 寄存器：如程序计数器 (PC)、栈指针 (SP)、通用寄存器等\
（2）进程状态：如 running, sleeping, zombie 等\
（3）内存管理信息：如页表（指向进程的虚拟内存空间）\
（4）内核栈：进程在内核态执行时使用的栈\
（5）文件描述符表：进程打开的所有文件
3. 可以休眠：代码可以调用可能导致阻塞的函数（例如，等待 I/O、请求锁、sleep()）。内核的调度器会介入，将该进程标记为休眠状态，并选择另一个进程运行。
4. 可以被抢占：内核可以决定暂停当前进程，转而运行一个更高优先级的进程。
5. 拥有明确的当前进程：在进程上下文中，内核始终知道它正在为哪个进程（current 指针）工作。
### 中断上下文
1. 内核在响应一个硬件中断（IRQ）或软中断 (Softirq) 时所处的环境
2. 它不与任何进程关联，因此它的上下文信息非常有限，主要是中断发生时被强行保存的少量寄存器，没有完整的进程环境。
3. 绝对不能休眠：中断处理程序必须非常快地执行完毕。如果休眠了，系统可能会死锁，因为没有进程可以被调度回来唤醒它。
4. 不可抢占（通常情况下）：中断处理程序会抢占进程上下文，但它自己通常不会被其他进程抢占（但可能被更高优先级的中断抢占）。
5. 时间非常敏感：打断了系统上正在运行的任何代码（可能是进程上下文，甚至是另一个中断的下半部），因此必须尽快完成。
## 安全上下文
1. 一个安全标签，在 SELinux 安全模块中使用
2. 附加到系统中的所有对象（如进程、文件、目录、套接字、端口等）上，这个标签用于强制访问控制 (MAC)。
3. 一个由冒号分隔的字符串，通常格式为：user:role:type:level\
（1）User (用户)：SELinux 用户身份（不同于 Linux 系统用户）\
（2）Role (角色)：定义了用户可以扮演的角色\
（3）Type (类型)：最重要的部分。SELinux 的核心策略（称为类型强制）就是基于“类型”来制定的\
（4）Level (级别)：用于多级别安全 (MLS)，通常用于政府和军事环境，日常系统中较少见
4. SELinux 的策略规则定义了“一个类型（如 httpd_t，Web 服务器进程）是否允许访问另一个类型（如 httpd_sys_content_t，Web 内容文件）”